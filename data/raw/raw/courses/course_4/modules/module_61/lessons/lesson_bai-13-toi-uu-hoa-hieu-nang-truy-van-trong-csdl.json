{
  "title": "B√ÄI 13 ‚Äì T·ªêI ∆ØU H√ìA HI·ªÜU NƒÇNG TRUY V·∫§N TRONG CSDL",
  "created_at": "2025-10-25T05:44:52Z",
  "url": "bai-13-toi-uu-hoa-hieu-nang-truy-van-trong-csdl",
  "editing_roles": "teachers",
  "page_id": 253,
  "last_edited_by": {
    "id": 1,
    "anonymous_id": "1",
    "display_name": "admin@gmail.com",
    "avatar_image_url": "http://localhost:3000/images/messages/avatar-50.png",
    "html_url": "http://localhost:3000/courses/4/users/1",
    "pronouns": null
  },
  "published": true,
  "hide_from_students": false,
  "front_page": false,
  "html_url": "http://localhost:3000/courses/4/pages/bai-13-toi-uu-hoa-hieu-nang-truy-van-trong-csdl",
  "todo_date": null,
  "publish_at": null,
  "updated_at": "2025-10-25T05:45:07Z",
  "locked_for_user": false,
  "body": "<h1>üß© B√ÄI 13 ‚Äì T·ªêI ∆ØU H√ìA HI·ªÜU NƒÇNG TRUY V·∫§N TRONG C∆† S·ªû D·ªÆ LI·ªÜU</h1><h2>üéØ M·ª•c ti√™u h·ªçc t·∫≠p</h2><ul><li>Hi·ªÉu r√µ c√°c y·∫øu t·ªë ·∫£nh h∆∞·ªüng ƒë·∫øn hi·ªáu nƒÉng truy v·∫•n trong DBMS.</li><li>N·∫Øm v·ªØng vai tr√≤ c·ªßa ch·ªâ m·ª•c (index), th·ªëng k√™ (statistics), v√† k·∫ø ho·∫°ch th·ª±c thi (execution plan).</li><li>Bi·∫øt c√°ch ph√¢n t√≠ch v√† t·ªëi ∆∞u h√≥a truy v·∫•n SQL b·∫±ng EXPLAIN/EXPLAIN ANALYZE.</li><li>Th·ª±c h√†nh c·∫£i thi·ªán hi·ªáu nƒÉng b·∫±ng k·ªπ thu·∫≠t indexing, partitioning, caching, v√† query rewriting.</li></ul><hr><h2>1. T·ªîNG QUAN V·ªÄ HI·ªÜU NƒÇNG TRUY V·∫§N</h2><p>Hi·ªáu nƒÉng truy v·∫•n ph·ª• thu·ªôc v√†o ba y·∫øu t·ªë ch√≠nh: <b>c·∫•u tr√∫c d·ªØ li·ªáu</b>, <b>c√°ch vi·∫øt truy v·∫•n</b> v√† <b>chi·∫øn l∆∞·ª£c t·ªëi ∆∞u c·ªßa DBMS</b>. M·ªôt truy v·∫•n kh√¥ng t·ªëi ∆∞u c√≥ th·ªÉ ti√™u t·ªën h√†ng gi√¢y ho·∫∑c h√†ng ph√∫t thay v√¨ mili gi√¢y.</p><p>V√≠ d·ª•: truy v·∫•n ch∆∞a c√≥ ch·ªâ m·ª•c</p><pre><code>SELECT * FROM HoaDon WHERE NgayLap = '2025-10-10';</code></pre><p>Khi b·∫£ng HoaDon c√≥ h√†ng tri·ªáu b·∫£n ghi, vi·ªác t√¨m ki·∫øm tu·∫ßn t·ª± (sequential scan) s·∫Ω r·∫•t ch·∫≠m n·∫øu kh√¥ng c√≥ ch·ªâ m·ª•c.</p><hr><h2>2. CH·ªà M·ª§C (INDEX)</h2><h3>2.1 Kh√°i ni·ªám</h3><p>Ch·ªâ m·ª•c l√† c·∫•u tr√∫c d·ªØ li·ªáu gi√∫p tƒÉng t·ªëc ƒë·ªô truy xu·∫•t, t∆∞∆°ng t·ª± m·ª•c l·ª•c trong s√°ch. DBMS th∆∞·ªùng s·ª≠ d·ª•ng c√¢y B+Tree, Hash Index ho·∫∑c GiST Index.</p><h3>2.2 C√∫ ph√°p t·∫°o ch·ªâ m·ª•c</h3><pre><code>CREATE INDEX idx_HoaDon_NgayLap ON HoaDon(NgayLap);</code></pre><ul><li><b>Clustered index:</b> l∆∞u tr·ªØ d·ªØ li·ªáu v·∫≠t l√Ω theo th·ª© t·ª± c·ªßa ch·ªâ m·ª•c (ch·ªâ c√≥ m·ªôt trong m·ªói b·∫£ng).</li><li><b>Non-clustered index:</b> ch·ªâ ch·ª©a con tr·ªè ƒë·∫øn d·ªØ li·ªáu g·ªëc, c√≥ th·ªÉ c√≥ nhi·ªÅu.</li></ul><h3>2.3 Khi n√†o KH√îNG n√™n d√πng index</h3><ul><li>B·∫£ng nh·ªè, √≠t b·∫£n ghi.</li><li>C√°c c·ªôt th∆∞·ªùng xuy√™n c·∫≠p nh·∫≠t (INSERT/UPDATE/DELETE nhi·ªÅu).</li><li>Truy v·∫•n tr·∫£ v·ªÅ ph·∫ßn l·ªõn d·ªØ li·ªáu.</li></ul><hr><h2>3. K·∫æ HO·∫†CH TH·ª∞C THI (EXECUTION PLAN)</h2><p>DBMS ph√¢n t√≠ch c√¢u l·ªánh SQL v√† ch·ªçn chi·∫øn l∆∞·ª£c th·ª±c thi t·ªët nh·∫•t.</p><pre><code>EXPLAIN SELECT MaSV, Diem FROM KetQua WHERE Diem &gt;= 8;</code></pre><p>C√°c b∆∞·ªõc ch√≠nh:</p><ul><li>Ph√¢n t√≠ch c√∫ ph√°p (Parsing)</li><li>T·ªëi ∆∞u h√≥a logic (Logical Optimization)</li><li>T·ªëi ∆∞u h√≥a v·∫≠t l√Ω (Physical Optimization)</li><li>Th·ª±c thi (Execution)</li></ul><p>K·∫øt qu·∫£ c·ªßa EXPLAIN gi√∫p nh·∫≠n bi·∫øt truy v·∫•n n√†o ƒëang scan to√†n b·∫£ng (Seq Scan) ho·∫∑c s·ª≠ d·ª•ng Index Scan.</p><hr><h2>4. T·ªêI ∆ØU H√ìA TRUY V·∫§N SQL</h2><h3>4.1 Vi·∫øt truy v·∫•n hi·ªáu qu·∫£</h3><ul><li>Ch·ªâ ch·ªçn c√°c c·ªôt c·∫ßn thi·∫øt thay v√¨ *.</li><li>D√πng EXISTS thay cho IN trong nhi·ªÅu tr∆∞·ªùng h·ª£p.</li><li>Tr√°nh h√†m tr√™n c·ªôt trong WHERE (v√≠ d·ª•: <code>WHERE YEAR(NgayLap)=2025</code> ‚Üí <code>WHERE NgayLap BETWEEN ...</code>).</li></ul><h3>4.2 S·ª≠ d·ª•ng JOIN h·ª£p l√Ω</h3><ul><li>ƒê·∫£m b·∫£o c√°c c·ªôt JOIN c√≥ ch·ªâ m·ª•c.</li><li>D√πng INNER JOIN thay cho OUTER JOIN khi c√≥ th·ªÉ.</li></ul><h3>4.3 T·ªëi ∆∞u h√≥a GROUP BY v√† ORDER BY</h3><p>S·ª≠ d·ª•ng index h·ªó tr·ª£ s·∫Øp x·∫øp ho·∫∑c t·ªïng h·ª£p s·∫Ω gi·∫£m chi ph√≠ t√≠nh to√°n.</p><hr><h2>5. PH√ÇN M·∫¢NH (PARTITIONING)</h2><p>Ph√¢n chia b·∫£ng l·ªõn th√†nh nhi·ªÅu ph·∫ßn nh·ªè (partition) d·ª±a tr√™n ƒëi·ªÅu ki·ªán logic nh∆∞ ng√†y, v√πng, ho·∫∑c lo·∫°i d·ªØ li·ªáu.</p><pre><code>CREATE TABLE HoaDon2025 PARTITION OF HoaDon FOR VALUES FROM ('2025-01-01') TO ('2025-12-31');</code></pre><p>L·ª£i √≠ch: truy v·∫•n ch·ªâ qu√©t d·ªØ li·ªáu trong partition ph√π h·ª£p, ti·∫øt ki·ªám th·ªùi gian v√† b·ªô nh·ªõ.</p><hr><h2>6. B·ªò NH·ªö ƒê·ªÜM (CACHE) V√Ä TH·ªêNG K√ä</h2><ul><li><b>Query Cache:</b> L∆∞u k·∫øt qu·∫£ truy v·∫•n th∆∞·ªùng d√πng.</li><li><b>Statistics:</b> Th√¥ng tin th·ªëng k√™ gi√∫p optimizer ch·ªçn k·∫ø ho·∫°ch t·ªëi ∆∞u.</li></ul><p>C·∫≠p nh·∫≠t th·ªëng k√™ ƒë·ªãnh k·ª≥:</p><pre><code>ANALYZE HoaDon;</code></pre><hr><h2>7. TH·ª∞C H√ÄNH PH√ÇN T√çCH HI·ªÜU NƒÇNG</h2><p>D√πng EXPLAIN ANALYZE trong PostgreSQL ƒë·ªÉ ƒëo th·ªùi gian th·ª±c t·∫ø:</p><pre><code>EXPLAIN ANALYZE SELECT * FROM HoaDon WHERE NgayLap = '2025-10-10';</code></pre><p>‚Üí Output: <code>Index Scan using idx_HoaDon_NgayLap cost=0.43..8.75 rows=1 width=100</code></p><p>Gi√∫p ph√°t hi·ªán bottleneck (n√∫t th·∫Øt c·ªï chai) trong truy v·∫•n.</p><hr><h2>‚úÖ T·ªîNG K·∫æT</h2><ul><li>Index l√† c√¥ng c·ª• m·∫°nh m·∫Ω gi√∫p tƒÉng t·ªëc ƒë·ªô truy v·∫•n, nh∆∞ng c·∫ßn s·ª≠ d·ª•ng h·ª£p l√Ω.</li><li>EXPLAIN v√† EXPLAIN ANALYZE gi√∫p ƒë√°nh gi√° hi·ªáu qu·∫£ th·ª±c thi truy v·∫•n.</li><li>Ph√¢n m·∫£nh d·ªØ li·ªáu, caching v√† t·ªëi ∆∞u c√¢u SQL l√† k·ªπ nƒÉng thi·∫øt y·∫øu ƒë·ªÉ t·ªëi ∆∞u h·ªá th·ªëng th·ª±c t·∫ø.</li></ul>"
}