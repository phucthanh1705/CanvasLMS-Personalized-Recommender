<h1>üß© B√ÄI 15 ‚Äì TRUY V·∫§N CON, H√ÄM T·∫¨P H·ª¢P V√Ä VIEW TRONG C∆† S·ªû D·ªÆ LI·ªÜU</h1><h2>üéØ M·ª•c ti√™u h·ªçc t·∫≠p</h2><ul><li>Hi·ªÉu r√µ kh√°i ni·ªám v√† c√°ch s·ª≠ d·ª•ng truy v·∫•n con (subquery) trong SQL.</li><li>N·∫Øm ƒë∆∞·ª£c c√°c h√†m t·∫≠p h·ª£p (aggregate functions) v√† c√°ch k·∫øt h·ª£p ch√∫ng v·ªõi GROUP BY v√† HAVING.</li><li>Bi·∫øt c√°ch t·∫°o, s·ª≠ d·ª•ng v√† c·∫≠p nh·∫≠t VIEW (khung nh√¨n) ƒë·ªÉ ƒë∆°n gi·∫£n h√≥a truy v·∫•n v√† tƒÉng b·∫£o m·∫≠t d·ªØ li·ªáu.</li><li>Ph√¢n bi·ªát truy v·∫•n l·ªìng nhau, truy v·∫•n t∆∞∆°ng quan (correlated subquery), v√† truy v·∫•n ƒëa t·∫ßng.</li></ul><hr><h2>1. KH√ÅI NI·ªÜM TRUY V·∫§N CON</h2><p>Truy v·∫•n con (Subquery) l√† m·ªôt truy v·∫•n SQL ƒë∆∞·ª£c l·ªìng trong truy v·∫•n kh√°c. K·∫øt qu·∫£ c·ªßa truy v·∫•n con c√≥ th·ªÉ ƒë∆∞·ª£c d√πng trong SELECT, WHERE ho·∫∑c FROM.</p><h3>1.1 C·∫•u tr√∫c c∆° b·∫£n</h3><pre><code>SELECT MaSV, HoTen FROM SinhVien<br>WHERE MaSV IN (SELECT MaSV FROM KetQua WHERE Diem &gt; 8);</code></pre><p>‚Üí Truy v·∫•n con l·∫•y danh s√°ch sinh vi√™n c√≥ ƒëi·ªÉm &gt; 8.</p><h3>1.2 Truy v·∫•n con c√≥ k·∫øt qu·∫£ ƒë∆°n</h3><pre><code>SELECT * FROM NhanVien WHERE Luong &gt; (SELECT AVG(Luong) FROM NhanVien);</code></pre><p>‚Üí So s√°nh t·ª´ng nh√¢n vi√™n v·ªõi m·ª©c l∆∞∆°ng trung b√¨nh to√†n b·ªô.</p><h3>1.3 Truy v·∫•n t∆∞∆°ng quan (Correlated Subquery)</h3><p>Truy v·∫•n con ph·ª• thu·ªôc v√†o gi√° tr·ªã c·ªßa truy v·∫•n cha:</p><pre><code>SELECT MaSV, HoTen<br>FROM SinhVien sv<br>WHERE Diem &gt; (SELECT AVG(Diem) FROM KetQua WHERE KetQua.MaSV = sv.MaSV);</code></pre><hr><h2>2. H√ÄM T·∫¨P H·ª¢P (AGGREGATE FUNCTIONS)</h2><ul><li><b>COUNT()</b> ‚Äì ƒê·∫øm s·ªë b·∫£n ghi.</li><li><b>SUM()</b> ‚Äì T√≠nh t·ªïng.</li><li><b>AVG()</b> ‚Äì Trung b√¨nh.</li><li><b>MIN()</b> ‚Äì Gi√° tr·ªã nh·ªè nh·∫•t.</li><li><b>MAX()</b> ‚Äì Gi√° tr·ªã l·ªõn nh·∫•t.</li></ul><h3>2.1 GROUP BY v√† HAVING</h3><p>D√πng ƒë·ªÉ nh√≥m d·ªØ li·ªáu v√† l·ªçc c√°c nh√≥m theo ƒëi·ªÅu ki·ªán.</p><pre><code>SELECT MaLop, AVG(Diem) AS DiemTB<br>FROM KetQua<br>GROUP BY MaLop<br>HAVING AVG(Diem) &gt;= 7;</code></pre><p>‚Üí L·∫•y c√°c l·ªõp c√≥ ƒëi·ªÉm trung b√¨nh ‚â• 7.</p><hr><h2>3. VIEW (KHUNG NH√åN)</h2><p>View l√† b·∫£ng ·∫£o t·∫°o t·ª´ k·∫øt qu·∫£ c·ªßa truy v·∫•n. Gi√∫p ƒë∆°n gi·∫£n h√≥a truy v·∫•n ph·ª©c t·∫°p v√† b·∫£o m·∫≠t d·ªØ li·ªáu nh·∫°y c·∫£m.</p><h3>3.1 T·∫°o view</h3><pre><code>CREATE VIEW View_DiemSV AS<br>SELECT sv.MaSV, sv.HoTen, kq.MaMon, kq.Diem<br>FROM SinhVien sv<br>JOIN KetQua kq ON sv.MaSV = kq.MaSV;</code></pre><h3>3.2 C·∫≠p nh·∫≠t view</h3><pre><code>UPDATE View_DiemSV SET Diem = 10 WHERE MaSV = 'SV01' AND MaMon = 'CSDL';</code></pre><h3>3.3 X√≥a view</h3><pre><code>DROP VIEW View_DiemSV;</code></pre><hr><h2>4. ·ª®NG D·ª§NG VIEW TRONG B·∫¢O M·∫¨T</h2><p>View gi√∫p ·∫©n d·ªØ li·ªáu nh·∫°y c·∫£m (v√≠ d·ª•: l∆∞∆°ng, th√¥ng tin c√° nh√¢n) v√† ch·ªâ hi·ªÉn th·ªã th√¥ng tin c·∫ßn thi·∫øt.</p><pre><code>CREATE VIEW View_NhanVienPublic AS<br>SELECT MaNV, HoTen, ChucVu FROM NhanVien;</code></pre><p>‚Üí Ng∆∞·ªùi d√πng ch·ªâ xem ƒë∆∞·ª£c th√¥ng tin c∆° b·∫£n, kh√¥ng th·∫•y m·ª©c l∆∞∆°ng.</p><hr><h2>5. TRUY V·∫§N L·ªíNG NHAU NHI·ªÄU T·∫¶NG</h2><p>SQL cho ph√©p l·ªìng nhi·ªÅu truy v·∫•n con trong nhau:</p><pre><code>SELECT MaSV FROM KetQua<br>WHERE MaMon = (SELECT MaMon FROM MonHoc WHERE TenMon = 'CSDL')<br>AND Diem &gt; (SELECT AVG(Diem) FROM KetQua);</code></pre><p>C·∫ßn t·ªëi ∆∞u subquery v√¨ n·∫øu l·ªìng qu√° s√¢u s·∫Ω l√†m gi·∫£m hi·ªáu nƒÉng.</p><hr><h2>6. TRUY V·∫§N CON V√Ä JOIN</h2><p>Trong nhi·ªÅu tr∆∞·ªùng h·ª£p, JOIN c√≥ th·ªÉ thay th·∫ø subquery ƒë·ªÉ tƒÉng hi·ªáu nƒÉng:</p><pre><code>-- Subquery<br>SELECT MaSV, HoTen FROM SinhVien<br>WHERE MaSV IN (SELECT MaSV FROM KetQua WHERE Diem &gt;= 8);<br><br>-- JOIN t∆∞∆°ng ƒë∆∞∆°ng<br>SELECT DISTINCT sv.MaSV, sv.HoTen<br>FROM SinhVien sv<br>JOIN KetQua kq ON sv.MaSV = kq.MaSV<br>WHERE kq.Diem &gt;= 8;</code></pre><hr><h2>‚úÖ T·ªîNG K·∫æT</h2><ul><li>Subquery cho ph√©p x·ª≠ l√Ω linh ho·∫°t c√°c truy v·∫•n ph·ª©c t·∫°p.</li><li>Aggregate functions k·∫øt h·ª£p v·ªõi GROUP BY v√† HAVING gi√∫p t·ªïng h·ª£p d·ªØ li·ªáu m·∫°nh m·∫Ω.</li><li>VIEW l√† c√¥ng c·ª• h·ªØu √≠ch trong b·∫£o m·∫≠t v√† t·ªëi ∆∞u h√≥a truy v·∫•n.</li><li>Hi·ªÉu v√† s·ª≠ d·ª•ng h·ª£p l√Ω gi·ªØa Subquery v√† JOIN gi√∫p tƒÉng hi·ªáu nƒÉng h·ªá th·ªëng.</li></ul>