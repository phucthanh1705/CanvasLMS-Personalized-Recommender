{
  "title": "B√ÄI 08 ‚Äì ADO.NET (K·∫æT N·ªêI C∆† S·ªû D·ªÆ LI·ªÜU)",
  "created_at": "2025-10-14T08:36:37Z",
  "url": "bai-08-ado-dot-net-ket-noi-co-so-du-lieu",
  "editing_roles": "teachers",
  "page_id": 141,
  "last_edited_by": {
    "id": 1,
    "anonymous_id": "1",
    "display_name": "admin@gmail.com",
    "avatar_image_url": "http://localhost:3000/images/messages/avatar-50.png",
    "html_url": "http://localhost:3000/courses/4/users/1",
    "pronouns": null
  },
  "published": true,
  "hide_from_students": false,
  "front_page": false,
  "html_url": "http://localhost:3000/courses/4/pages/bai-08-ado-dot-net-ket-noi-co-so-du-lieu",
  "todo_date": null,
  "publish_at": null,
  "updated_at": "2025-10-14T08:36:51Z",
  "locked_for_user": false,
  "body": "<h1>üß© B√ÄI 08 ‚Äì ADO.NET</h1><h2>üéØ M·ª•c ti√™u h·ªçc t·∫≠p</h2><ul>  <li>Hi·ªÉu ki·∫øn tr√∫c v√† th√†nh ph·∫ßn c·ªßa ADO.NET.</li>  <li>Bi·∫øt c√°ch k·∫øt n·ªëi, truy v·∫•n, v√† thao t√°c d·ªØ li·ªáu v·ªõi SQL Server.</li>  <li>N·∫Øm r√µ ƒë·ªëi t∆∞·ª£ng <code>SqlConnection</code>, <code>SqlCommand</code>, <code>SqlDataAdapter</code>, <code>DataTable</code>.</li>  <li>Th·ª±c h√†nh CRUD (Create, Read, Update, Delete) trong Windows Form.</li>  <li>Hi·ªÉu c∆° ch·∫ø ho·∫°t ƒë·ªông k·∫øt n·ªëi online/offline (Connected vs Disconnected).</li></ul><hr><h2>1. Gi·ªõi thi·ªáu ADO.NET</h2><p><b>ADO.NET</b> l√† th∆∞ vi·ªán truy c·∫≠p d·ªØ li·ªáu c·ªßa .NET Framework, cho ph√©p l√†m vi·ªác v·ªõi c√°c ngu·ªìn d·ªØ li·ªáu nh∆∞ SQL Server, Oracle, XML, v.v.</p><p>Hai m√¥ h√¨nh l√†m vi·ªác ch√≠nh:</p><ul>  <li><b>Connected:</b> truy c·∫≠p tr·ª±c ti·∫øp b·∫±ng <code>SqlCommand</code> v√† <code>SqlDataReader</code>.</li>  <li><b>Disconnected:</b> s·ª≠ d·ª•ng <code>DataAdapter</code>, <code>DataSet</code>, <code>DataTable</code> ƒë·ªÉ l∆∞u tr·ªØ t·∫°m d·ªØ li·ªáu.</li></ul><hr><h2>2. C√°c th√†nh ph·∫ßn ch√≠nh</h2><table border=\"1\" cellpadding=\"6\"><thead><tr><th>Th√†nh ph·∫ßn</th><th>M√¥ t·∫£</th></tr></thead><tbody><tr><td><b>SqlConnection</b></td><td>T·∫°o v√† qu·∫£n l√Ω k·∫øt n·ªëi t·ªõi c∆° s·ªü d·ªØ li·ªáu SQL Server.</td></tr><tr><td><b>SqlCommand</b></td><td>Th·ª±c thi c√¢u l·ªánh SQL ho·∫∑c stored procedure.</td></tr><tr><td><b>SqlDataReader</b></td><td>ƒê·ªçc d·ªØ li·ªáu nhanh, ch·ªâ ti·∫øn (forward-only).</td></tr><tr><td><b>SqlDataAdapter</b></td><td>Trung gian gi·ªØa DataSet v√† c∆° s·ªü d·ªØ li·ªáu.</td></tr><tr><td><b>DataSet / DataTable</b></td><td>L∆∞u d·ªØ li·ªáu trong b·ªô nh·ªõ, c√≥ th·ªÉ thao t√°c offline.</td></tr></tbody></table><hr><h2>3. K·∫øt n·ªëi ƒë·∫øn SQL Server</h2><pre><code>using System.Data.SqlClient;string connStr = \"Data Source=localhost;Initial Catalog=QLSinhVien;Integrated Security=True\";SqlConnection conn = new SqlConnection(connStr);try {    conn.Open();    MessageBox.Show(\"K·∫øt n·ªëi th√†nh c√¥ng!\");} catch (Exception ex) {    MessageBox.Show($\"L·ªói: {ex.Message}\");} finally {    conn.Close();}</code></pre><hr><h2>4. ƒê·ªçc d·ªØ li·ªáu b·∫±ng SqlDataReader</h2><pre><code>string sql = \"SELECT MaSV, HoTen FROM SinhVien\";SqlCommand cmd = new SqlCommand(sql, conn);conn.Open();SqlDataReader reader = cmd.ExecuteReader();while (reader.Read()) {    Console.WriteLine($\"{reader[\"MaSV\"]} - {reader[\"HoTen\"]}\");}conn.Close();</code></pre><p><b>SqlDataReader</b> cho ph√©p ƒë·ªçc d·ªØ li·ªáu tu·∫ßn t·ª±, hi·ªáu nƒÉng cao.</p><hr><h2>5. Thao t√°c CRUD c∆° b·∫£n</h2><pre><code>// Th√™m sinh vi√™nstring insert = \"INSERT INTO SinhVien(MaSV, HoTen) VALUES(@ma, @ten)\";SqlCommand cmd = new SqlCommand(insert, conn);cmd.Parameters.AddWithValue(\"@ma\", txtMa.Text);cmd.Parameters.AddWithValue(\"@ten\", txtTen.Text);conn.Open();cmd.ExecuteNonQuery();conn.Close();MessageBox.Show(\"ƒê√£ th√™m th√†nh c√¥ng!\");</code></pre><pre><code>// C·∫≠p nh·∫≠t d·ªØ li·ªáustring update = \"UPDATE SinhVien SET HoTen=@ten WHERE MaSV=@ma\";SqlCommand cmd2 = new SqlCommand(update, conn);cmd2.Parameters.AddWithValue(\"@ma\", txtMa.Text);cmd2.Parameters.AddWithValue(\"@ten\", txtTen.Text);cmd2.ExecuteNonQuery();</code></pre><pre><code>// X√≥a d·ªØ li·ªáustring delete = \"DELETE FROM SinhVien WHERE MaSV=@ma\";SqlCommand cmd3 = new SqlCommand(delete, conn);cmd3.Parameters.AddWithValue(\"@ma\", txtMa.Text);cmd3.ExecuteNonQuery();</code></pre><hr><h2>6. L√†m vi·ªác v·ªõi DataAdapter v√† DataTable</h2><pre><code>string sql = \"SELECT * FROM SinhVien\";SqlDataAdapter da = new SqlDataAdapter(sql, conn);DataTable dt = new DataTable();da.Fill(dt);dataGridView1.DataSource = dt;</code></pre><p><b>∆Øu ƒëi·ªÉm:</b> C√≥ th·ªÉ thao t√°c d·ªØ li·ªáu offline v√† c·∫≠p nh·∫≠t l·∫°i sau b·∫±ng <code>da.Update()</code>.</p><hr><h2>7. S·ª≠ d·ª•ng Stored Procedure</h2><pre><code>SqlCommand cmd = new SqlCommand(\"sp_ThemSinhVien\", conn);cmd.CommandType = CommandType.StoredProcedure;cmd.Parameters.AddWithValue(\"@MaSV\", txtMa.Text);cmd.Parameters.AddWithValue(\"@HoTen\", txtTen.Text);conn.Open();cmd.ExecuteNonQuery();conn.Close();</code></pre><hr><h2>üß† B√†i t·∫≠p th·ª±c h√†nh</h2><ol>  <li>T·∫°o c∆° s·ªü d·ªØ li·ªáu QLSinhVien g·ªìm b·∫£ng <code>SinhVien(MaSV, HoTen, NgaySinh, Lop)</code>.</li>  <li>X√¢y d·ª±ng Form k·∫øt n·ªëi SQL Server v√† hi·ªÉn th·ªã d·ªØ li·ªáu trong DataGridView.</li>  <li>Th√™m, s·ª≠a, x√≥a sinh vi√™n b·∫±ng SqlCommand v√† Parameter.</li>  <li>Th·ª±c hi·ªán t√¨m ki·∫øm sinh vi√™n theo t√™n.</li>  <li>D√πng DataAdapter ƒë·ªÉ load d·ªØ li·ªáu v√†o DataTable.</li></ol><hr><h2>‚úÖ T·ªïng k·∫øt</h2><ul>  <li>ADO.NET l√† n·ªÅn t·∫£ng truy c·∫≠p d·ªØ li·ªáu c·ªßa .NET Framework.</li>  <li>C√°c ƒë·ªëi t∆∞·ª£ng ch√≠nh: SqlConnection, SqlCommand, SqlDataReader, DataAdapter, DataTable.</li>  <li>H·ªó tr·ª£ c·∫£ m√¥ h√¨nh Connected v√† Disconnected.</li>  <li>Th·ª±c h√†nh CRUD gi√∫p hi·ªÉu quy tr√¨nh giao ti·∫øp gi·ªØa ·ª©ng d·ª•ng v√† SQL Server.</li></ul>"
}