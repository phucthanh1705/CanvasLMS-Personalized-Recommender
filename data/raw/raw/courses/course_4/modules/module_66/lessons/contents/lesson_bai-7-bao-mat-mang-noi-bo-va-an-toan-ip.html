<h1>üß± B√ÄI 7 ‚Äì B·∫¢O M·∫¨T M·∫†NG N·ªòI B·ªò V√Ä AN TO√ÄN IP</h1><h2>üéØ M·ª•c ti√™u h·ªçc t·∫≠p</h2><ul><li>Hi·ªÉu c∆° ch·∫ø b·∫£o m·∫≠t ·ªü l·ªõp m·∫°ng (Network Layer) v√† t·∫ßm quan tr·ªçng c·ªßa IPsec.</li><li>Ph√¢n bi·ªát hai ch·∫ø ƒë·ªô ho·∫°t ƒë·ªông c·ªßa IPsec: Transport Mode v√† Tunnel Mode.</li><li>N·∫Øm vai tr√≤ c·ªßa c√°c giao th·ª©c AH, ESP, IKE v√† c∆° ch·∫ø trao ƒë·ªïi kh√≥a b·∫£o m·∫≠t.</li><li>Hi·ªÉu kh√°i ni·ªám VPN v√† t∆∞·ªùng l·ª≠a l·ªõp 3‚Äì4 trong b·∫£o v·ªá m·∫°ng n·ªôi b·ªô.</li></ul><hr><h2>1. T·ªîNG QUAN B·∫¢O M·∫¨T M·∫†NG N·ªòI B·ªò</h2><p>M·∫°ng n·ªôi b·ªô (LAN/Intranet) th∆∞·ªùng b·ªã xem l√† an to√†n, nh∆∞ng th·ª±c t·∫ø ch·ª©a nhi·ªÅu r·ªßi ro: truy c·∫≠p tr√°i ph√©p, nghe l√©n ARP, gi·∫£ m·∫°o DHCP, v√† t·∫•n c√¥ng n·ªôi b·ªô (insider attack). B·∫£o m·∫≠t m·∫°ng n·ªôi b·ªô l√† s·ª± k·∫øt h·ª£p gi·ªØa ki·ªÉm so√°t truy c·∫≠p, m√£ h√≥a d·ªØ li·ªáu, gi√°m s√°t lu·ªìng th√¥ng tin v√† c√°ch ly v√πng m·∫°ng.</p><ul><li><b>Segmentation:</b> chia m·∫°ng theo VLAN, zone DMZ, h·∫°n ch·∫ø broadcast.</li><li><b>Firewall:</b> l·ªçc g√≥i, ch·∫∑n c·ªïng, ki·ªÉm so√°t NAT.</li><li><b>IDS/IPS:</b> ph√°t hi·ªán v√† ngƒÉn ch·∫∑n x√¢m nh·∫≠p.</li><li><b>Zero Trust:</b> kh√¥ng tin c·∫≠y m·∫∑c ƒë·ªãnh b·∫•t k·ª≥ thi·∫øt b·ªã n√†o.</li></ul><hr><h2>2. GIAO TH·ª®C IPsec</h2><p><b>IPsec (Internet Protocol Security)</b> l√† b·ªô giao th·ª©c b·∫£o m·∫≠t ·ªü l·ªõp m·∫°ng, cung c·∫•p c√°c d·ªãch v·ª•: m√£ h√≥a, x√°c th·ª±c, to√†n v·∫πn v√† ch·ªëng ph√°t l·∫°i cho c√°c g√≥i IP. IPsec c√≥ th·ªÉ ho·∫°t ƒë·ªông tr√™n IPv4 v√† IPv6.</p><h3>2.1 Th√†nh ph·∫ßn ch√≠nh</h3><ul><li><b>AH (Authentication Header):</b> cung c·∫•p x√°c th·ª±c v√† to√†n v·∫πn nh∆∞ng kh√¥ng m√£ h√≥a d·ªØ li·ªáu.</li><li><b>ESP (Encapsulating Security Payload):</b> cung c·∫•p m√£ h√≥a, x√°c th·ª±c v√† ch·ªëng replay attack.</li><li><b>IKE (Internet Key Exchange):</b> th·ª±c hi·ªán trao ƒë·ªïi kh√≥a t·ª± ƒë·ªông gi·ªØa hai b√™n, d·ª±a tr√™n Diffie‚ÄìHellman.</li></ul><h3>2.2 Hai ch·∫ø ƒë·ªô ho·∫°t ƒë·ªông</h3><ul><li><b>Transport Mode:</b> ch·ªâ m√£ h√≥a payload c·ªßa g√≥i IP, gi·ªØ nguy√™n header ‚Üí d√πng cho host-to-host.</li><li><b>Tunnel Mode:</b> m√£ h√≥a to√†n b·ªô g√≥i IP, bao b·ªçc trong IP m·ªõi ‚Üí d√πng cho VPN site-to-site ho·∫∑c remote access.</li></ul><hr><h2>3. HO·∫†T ƒê·ªòNG IPsec</h2><p>Khi thi·∫øt l·∫≠p k·∫øt n·ªëi, IPsec tr·∫£i qua hai pha IKE:</p><ul><li><b>Pha 1:</b> Thi·∫øt l·∫≠p k√™nh b·∫£o m·∫≠t IKE SA ‚Äì x√°c th·ª±c v√† t·∫°o kh√≥a chung.</li><li><b>Pha 2:</b> T·∫°o IPsec SA ‚Äì x√°c ƒë·ªãnh giao th·ª©c (AH ho·∫∑c ESP), ch·∫ø ƒë·ªô, thu·∫≠t to√°n m√£ h√≥a (AES, 3DES), v√† th·ªùi gian s·ªëng SA.</li></ul><p>IPsec s·ª≠ d·ª•ng thu·∫≠t to√°n m√£ h√≥a ƒë·ªëi x·ª©ng cho d·ªØ li·ªáu (AES-CBC, AES-GCM) v√† RSA/ECDH cho trao ƒë·ªïi kh√≥a.</p><p><b>Replay Protection:</b> m·ªói g√≥i mang Sequence Number; n·∫øu s·ªë tr√πng ‚Üí b·ªã lo·∫°i b·ªè.</p><hr><h2>4. VPN (M·∫†NG RI√äNG ·∫¢O)</h2><p><b>VPN</b> (Virtual Private Network) s·ª≠ d·ª•ng ƒë∆∞·ªùng truy·ªÅn c√¥ng c·ªông ƒë·ªÉ t·∫°o k√™nh li√™n l·∫°c an to√†n gi·ªØa c√°c m·∫°ng ri√™ng.</p><h3>4.1 Ph√¢n lo·∫°i:</h3><ul><li><b>Site-to-Site VPN:</b> k·∫øt n·ªëi hai m·∫°ng LAN qua Internet (th∆∞·ªùng d√πng IPsec Tunnel).</li><li><b>Remote Access VPN:</b> ng∆∞·ªùi d√πng t·ª´ xa truy c·∫≠p m·∫°ng n·ªôi b·ªô (PPTP, L2TP, IPsec, SSL-VPN).</li></ul><h3>4.2 Giao th·ª©c VPN ph·ªï bi·∫øn:</h3><ul><li><b>IPsec VPN:</b> b·∫£o m·∫≠t ·ªü l·ªõp m·∫°ng, ph√π h·ª£p doanh nghi·ªáp.</li><li><b>SSL VPN:</b> ho·∫°t ƒë·ªông l·ªõp ·ª©ng d·ª•ng, tri·ªÉn khai d·ªÖ qua tr√¨nh duy·ªát.</li><li><b>WireGuard:</b> th·∫ø h·ªá m·ªõi, nh·∫π, m√£ h√≥a m·∫°nh (ChaCha20, Poly1305).</li></ul><hr><h2>5. T∆Ø·ªúNG L·ª¨A L·ªöP 3‚Äì4</h2><p><b>Firewall l·ªõp 3‚Äì4</b> ho·∫°t ƒë·ªông ·ªü t·∫ßng IP v√† Transport, ki·ªÉm so√°t d·ª±a tr√™n ƒë·ªãa ch·ªâ IP ngu·ªìn/ƒë√≠ch, c·ªïng TCP/UDP v√† giao th·ª©c. C√≥ ba lo·∫°i ch√≠nh:</p><ul><li><b>Packet-filtering firewall:</b> ki·ªÉm tra t·ª´ng g√≥i IP.</li><li><b>Stateful firewall:</b> theo d√µi tr·∫°ng th√°i k·∫øt n·ªëi, ch·∫∑n b·∫•t th∆∞·ªùng.</li><li><b>Next-Generation Firewall (NGFW):</b> t√≠ch h·ª£p ki·ªÉm so√°t ·ª©ng d·ª•ng, DPI, IDS/IPS, SSL inspection.</li></ul><p>T∆∞·ªùng l·ª≠a th∆∞·ªùng k·∫øt h·ª£p v·ªõi NAT (Network Address Translation) ƒë·ªÉ ·∫©n ƒë·ªãa ch·ªâ IP n·ªôi b·ªô v√† ngƒÉn truy c·∫≠p tr·ª±c ti·∫øp t·ª´ Internet.</p><hr><h2>6. NAT TRAVERSAL (NAT-T)</h2><p>IPsec ESP kh√¥ng th·ªÉ ƒëi qua NAT v√¨ ESP kh√¥ng d√πng TCP/UDP port ‚Üí NAT kh√¥ng x·ª≠ l√Ω ƒë∆∞·ª£c checksum. Gi·∫£i ph√°p: <b>NAT-T</b> g√≥i IPsec ESP trong UDP (port 4500) ƒë·ªÉ v∆∞·ª£t NAT.</p><hr><h2>7. TRI·ªÇN KHAI IPSEC TRONG DOANH NGHI·ªÜP</h2><p>IPsec th∆∞·ªùng ƒë∆∞·ª£c tri·ªÉn khai gi·ªØa c√°c chi nh√°nh (site-to-site VPN) ho·∫∑c gi·ªØa ng∆∞·ªùi d√πng v√† h·ªá th·ªëng (remote VPN). Qu·∫£n tr·ªã vi√™n ƒë·ªãnh nghƒ©a ch√≠nh s√°ch SA (Security Association), thu·∫≠t to√°n m√£ h√≥a (AES-GCM), x√°c th·ª±c (HMAC-SHA256), v√† th·ªùi gian s·ªëng SA (lifetime).</p><hr><h2>‚úÖ T·ªîNG K·∫æT</h2><ul><li>IPsec b·∫£o v·ªá d·ªØ li·ªáu ·ªü l·ªõp m·∫°ng, ƒë·∫£m b·∫£o to√†n v·∫πn, x√°c th·ª±c v√† b√≠ m·∫≠t.</li><li>AH x√°c th·ª±c, ESP m√£ h√≥a v√† b·∫£o m·∫≠t to√†n di·ªán h∆°n.</li><li>VPN v√† Firewall gi√∫p ki·ªÉm so√°t v√† c√¥ l·∫≠p l∆∞u l∆∞·ª£ng hi·ªáu qu·∫£.</li><li>NAT-T ƒë·∫£m b·∫£o IPsec ho·∫°t ƒë·ªông trong m·∫°ng s·ª≠ d·ª•ng NAT.</li></ul>