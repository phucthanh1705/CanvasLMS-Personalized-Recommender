<h1>üß© B√ÄI 03 ‚Äì TRUY C·∫¨P D·ªÆ LI·ªÜU TRONG ASP.NET</h1><h2>üéØ M·ª•c ti√™u h·ªçc t·∫≠p</h2><ul><li>Hi·ªÉu ƒë∆∞·ª£c c√°ch ASP.NET giao ti·∫øp v·ªõi c∆° s·ªü d·ªØ li·ªáu SQL Server th√¥ng qua <strong>ADO.NET</strong>.</li><li>N·∫Øm r√µ vai tr√≤ c·ªßa c√°c l·ªõp nh∆∞ <code>SqlConnection</code>, <code>SqlCommand</code>, <code>SqlDataAdapter</code>, <code>DataSet</code>, <code>DataReader</code>.</li><li>Th·ª±c hi·ªán th√†nh th·∫°o c√°c thao t√°c <strong>CRUD</strong> (Create, Read, Update, Delete).</li><li>Hi·ªÉu c√∫ ph√°p truy v·∫•n d·ªØ li·ªáu b·∫±ng <strong>LINQ</strong>.</li><li>Th·ª±c h√†nh hi·ªÉn th·ªã d·ªØ li·ªáu b·∫±ng <strong>GridView</strong> k·∫øt h·ª£p <strong>SqlDataSource</strong>.</li></ul><hr><h2>1. T·ªïng quan ADO.NET</h2><p><b>ADO.NET</b> l√† c√¥ng ngh·ªá cho ph√©p ASP.NET truy c·∫≠p v√† thao t√°c d·ªØ li·ªáu t·ª´ nhi·ªÅu ngu·ªìn kh√°c nhau (SQL Server, Oracle, MySQL, Excel, XML‚Ä¶). ADO.NET g·ªìm 2 m√¥ h√¨nh ch√≠nh:</p><ul><li><b>Connected Model</b> ‚Äì K·∫øt n·ªëi tr·ª±c ti·∫øp v·ªõi CSDL (SqlConnection, SqlCommand, SqlDataReader).</li><li><b>Disconnected Model</b> ‚Äì L√†m vi·ªác v·ªõi d·ªØ li·ªáu t·∫°m th·ªùi (DataSet, DataTable, SqlDataAdapter).</li></ul><p>∆Øu ƒëi·ªÉm:</p><ul><li>T·ªëi ∆∞u t·ªëc ƒë·ªô truy v·∫•n.</li><li>T√°ch bi·ªát logic d·ªØ li·ªáu v√† giao di·ªán.</li><li>D·ªÖ d√†ng thao t√°c d·ªØ li·ªáu offline.</li></ul><hr><h2>2. C·∫•u h√¨nh chu·ªói k·∫øt n·ªëi trong Web.config</h2><p>Thay v√¨ khai b√°o chu·ªói k·∫øt n·ªëi nhi·ªÅu l·∫ßn trong code, ASP.NET cho ph√©p ƒë·ªãnh nghƒ©a trong file <code>Web.config</code>:</p><pre><code>&lt;configuration&gt;  &lt;connectionStrings&gt;    &lt;add name=\"QLSV\" connectionString=\"Data Source=localhost;Initial Catalog=QLSinhVien;Integrated Security=True\" providerName=\"System.Data.SqlClient\" /&gt;  &lt;/connectionStrings&gt;&lt;/configuration&gt;</code></pre><p>Truy c·∫≠p t·ª´ code-behind:</p><pre><code>using System.Configuration;string connStr = ConfigurationManager.ConnectionStrings[\"QLSV\"].ConnectionString;</code></pre><hr><h2>3. C√°c l·ªõp quan tr·ªçng trong ADO.NET</h2><table border="1" cellpadding="6" cellspacing="0"><thead><tr><th>L·ªõp</th><th>Ch·ª©c nƒÉng ch√≠nh</th></tr></thead><tbody><tr><td><b>SqlConnection</b></td><td>K·∫øt n·ªëi t·ªõi c∆° s·ªü d·ªØ li·ªáu SQL Server.</td></tr><tr><td><b>SqlCommand</b></td><td>Ch·ª©a v√† th·ª±c thi c√¢u l·ªánh SQL (SELECT, INSERT, UPDATE...).</td></tr><tr><td><b>SqlDataReader</b></td><td>ƒê·ªçc d·ªØ li·ªáu nhanh, ch·ªâ ti·∫øn t·ªõi (read-only, forward-only).</td></tr><tr><td><b>SqlDataAdapter</b></td><td>Trung gian gi·ªØa CSDL v√† b·ªô nh·ªõ ƒë·ªám (DataSet).</td></tr><tr><td><b>DataSet / DataTable</b></td><td>L∆∞u d·ªØ li·ªáu t·∫°m th·ªùi ƒë·ªÉ hi·ªÉn th·ªã ho·∫∑c x·ª≠ l√Ω offline.</td></tr></tbody></table><hr><h2>4. ƒê·ªçc d·ªØ li·ªáu b·∫±ng ADO.NET (Connected Model)</h2><p>V√≠ d·ª• ƒë·ªçc danh s√°ch sinh vi√™n t·ª´ b·∫£ng <code>SinhVien</code>:</p><pre><code>using System.Data.SqlClient;string connStr = \"Data Source=localhost;Initial Catalog=QLSinhVien;Integrated Security=True\";using (SqlConnection conn = new SqlConnection(connStr)){    conn.Open();    string sql = \"SELECT MaSV, HoTen, DiemTB FROM SinhVien\";    SqlCommand cmd = new SqlCommand(sql, conn);    SqlDataReader rd = cmd.ExecuteReader();    while (rd.Read())    {        Response.Write(rd[\"HoTen\"] + \" - ƒêi·ªÉm TB: \" + rd[\"DiemTB\"] + \"&lt;br&gt;\");    }    rd.Close();}</code></pre><ul><li><code>conn.Open()</code> ‚Äì m·ªü k·∫øt n·ªëi ƒë·∫øn SQL Server.</li><li><code>cmd.ExecuteReader()</code> ‚Äì ch·∫°y c√¢u truy v·∫•n v√† tr·∫£ v·ªÅ lu·ªìng d·ªØ li·ªáu.</li><li><code>rd.Read()</code> ‚Äì duy·ªát t·ª´ng d√≤ng d·ªØ li·ªáu k·∫øt qu·∫£.</li><li>D√πng <code>using()</code> ƒë·ªÉ t·ª± ƒë·ªông gi·∫£i ph√≥ng t√†i nguy√™n khi k·∫øt th√∫c.</li></ul><hr><h2>5. Thao t√°c th√™m, s·ª≠a, x√≥a d·ªØ li·ªáu (CRUD)</h2><h3>Th√™m d·ªØ li·ªáu (Insert)</h3><pre><code>string sql = \"INSERT INTO SinhVien(HoTen, DiemTB) VALUES(@name, @score)\";SqlCommand cmd = new SqlCommand(sql, conn);cmd.Parameters.AddWithValue(\"@name\", txtName.Text);cmd.Parameters.AddWithValue(\"@score\", txtScore.Text);cmd.ExecuteNonQuery();</code></pre><h3>S·ª≠a d·ªØ li·ªáu (Update)</h3><pre><code>string sql = \"UPDATE SinhVien SET DiemTB = @score WHERE MaSV = @id\";SqlCommand cmd = new SqlCommand(sql, conn);cmd.Parameters.AddWithValue(\"@score\", txtScore.Text);cmd.Parameters.AddWithValue(\"@id\", txtId.Text);cmd.ExecuteNonQuery();</code></pre><h3>X√≥a d·ªØ li·ªáu (Delete)</h3><pre><code>string sql = \"DELETE FROM SinhVien WHERE MaSV = @id\";SqlCommand cmd = new SqlCommand(sql, conn);cmd.Parameters.AddWithValue(\"@id\", txtId.Text);cmd.ExecuteNonQuery();</code></pre><p><b>Ghi nh·ªõ:</b> Lu√¥n s·ª≠ d·ª•ng <code>Parameters</code> ƒë·ªÉ tr√°nh t·∫•n c√¥ng SQL Injection!</p><hr><h2>6. L√†m vi·ªác v·ªõi DataSet (Disconnected Model)</h2><pre><code>SqlDataAdapter da = new SqlDataAdapter(\"SELECT * FROM SinhVien\", conn);DataSet ds = new DataSet();da.Fill(ds, \"SV\");GridView1.DataSource = ds.Tables[\"SV\"];GridView1.DataBind();</code></pre><ul><li>Kh√¥ng c·∫ßn m·ªü k·∫øt n·ªëi l√¢u d√†i.</li><li>C√≥ th·ªÉ x·ª≠ l√Ω d·ªØ li·ªáu tr√™n b·ªô nh·ªõ (RAM).</li><li>Ph√π h·ª£p cho ·ª©ng d·ª•ng web c·∫ßn hi·ªáu nƒÉng cao.</li></ul><hr><h2>7. Truy v·∫•n d·ªØ li·ªáu b·∫±ng LINQ to SQL</h2><pre><code>using (QLSinhVienDataContext db = new QLSinhVienDataContext()){    var list = from s in db.SinhViens               where s.DiemTB &gt;= 7               orderby s.HoTen               select s;    foreach (var sv in list)        Response.Write($\"{sv.HoTen} - {sv.DiemTB}&lt;br&gt;\");}</code></pre><ul><li>C√∫ ph√°p ng·∫Øn g·ªçn, d·ªÖ ƒë·ªçc.</li><li>T·ª± ƒë·ªông √°nh x·∫° l·ªõp (ORM ‚Äì Object Relational Mapping).</li><li>Tr√°nh l·ªói c√∫ ph√°p SQL.</li></ul><hr><h2>8. Hi·ªÉn th·ªã d·ªØ li·ªáu b·∫±ng SqlDataSource + GridView</h2><pre><code>&lt;asp:SqlDataSource ID=\"SqlDataSource1\" runat=\"server\" ConnectionString=\"&lt;%$ ConnectionStrings:QLSV %&gt;\" SelectCommand=\"SELECT MaSV, HoTen, DiemTB FROM SinhVien\" /&gt;&lt;asp:GridView ID=\"GridView1\" runat=\"server\" DataSourceID=\"SqlDataSource1\" AutoGenerateColumns=\"true\" BorderColor=\"Gray\" CellPadding=\"4\"/&gt;</code></pre><hr><h2>9. X·ª≠ l√Ω l·ªói khi l√†m vi·ªác v·ªõi CSDL</h2><pre><code>try{    conn.Open();    SqlCommand cmd = new SqlCommand(\"SELECT COUNT(*) FROM SinhVien\", conn);    int count = (int)cmd.ExecuteScalar();    Response.Write($\"T·ªïng s·ªë sinh vi√™n: {count}\");}catch (SqlException ex){    Response.Write(\"L·ªói: \" + ex.Message);}finally{    conn.Close();}</code></pre><hr><h2>10. ·ª®ng d·ª•ng th·ª±c t·∫ø: Trang danh s√°ch sinh vi√™n</h2><pre><code>// code-behind: Students.aspx.csprotected void btnAdd_Click(object sender, EventArgs e){    using (SqlConnection conn = new SqlConnection(connStr))    {        conn.Open();        string sql = \"INSERT INTO SinhVien(HoTen, DiemTB) VALUES(@name, @score)\";        SqlCommand cmd = new SqlCommand(sql, conn);        cmd.Parameters.AddWithValue(\"@name\", txtName.Text);        cmd.Parameters.AddWithValue(\"@score\", txtScore.Text);        cmd.ExecuteNonQuery();    }    GridView1.DataBind(); // l√†m m·ªõi d·ªØ li·ªáu}</code></pre><hr><h2>üß† B√†i t·∫≠p th·ª±c h√†nh</h2><ol><li>T·∫°o CSDL <code>QLSinhVien</code> g·ªìm b·∫£ng SinhVien(MaSV, HoTen, DiemTB).</li><li>T·∫°o trang WebForm hi·ªÉn th·ªã danh s√°ch sinh vi√™n b·∫±ng GridView + SqlDataSource.</li><li>Th√™m form nh·∫≠p sinh vi√™n m·ªõi, th·ª±c hi·ªán Insert b·∫±ng <code>ADO.NET</code>.</li><li>Th√™m ch·ª©c nƒÉng l·ªçc theo ƒëi·ªÉm (DiemTB &gt;= 8) b·∫±ng <code>LINQ</code>.</li><li>X·ª≠ l√Ω ngo·∫°i l·ªá k·∫øt n·ªëi SQL b·∫±ng <code>try-catch-finally</code>.</li></ol><hr><h2>‚úÖ T·ªïng k·∫øt</h2><ul><li>Hi·ªÉu quy tr√¨nh k·∫øt n·ªëi v√† truy v·∫•n d·ªØ li·ªáu trong ASP.NET.</li><li>Th√†nh th·∫°o ADO.NET, LINQ, v√† SqlDataSource.</li><li>√Åp d·ª•ng m√¥ h√¨nh CRUD trong ·ª©ng d·ª•ng web th·ª±c t·∫ø.</li><li>ƒê·∫∑t n·ªÅn t·∫£ng cho c√°c b√†i h·ªçc ti·∫øp theo v·ªÅ Entity Framework v√† ORM n√¢ng cao.</li></ul>