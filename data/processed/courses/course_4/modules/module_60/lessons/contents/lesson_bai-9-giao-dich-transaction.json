{
  "id": "lesson_bai-9-giao-dich-transaction",
  "title": "lesson_bai-9-giao-dich-transaction",
  "body": "<h1>ğŸ§© BÃ€I 9 â€“ GIAO Dá»ŠCH (TRANSACTION)</h1><h2>ğŸ¯ Má»¥c tiÃªu há»c táº­p</h2><ul><li>Hiá»ƒu khÃ¡i niá»‡m giao dá»‹ch vÃ  vai trÃ² trong quáº£n lÃ½ dá»¯ liá»‡u nháº¥t quÃ¡n.</li><li>Náº¯m Ä‘Æ°á»£c bá»‘n thuá»™c tÃ­nh ACID cá»§a giao dá»‹ch.</li><li>Biáº¿t sá»­ dá»¥ng COMMIT, ROLLBACK vÃ  SAVEPOINT trong SQL.</li><li>Nháº­n biáº¿t vÃ  xá»­ lÃ½ cÃ¡c váº¥n Ä‘á» Ä‘á»“ng thá»i: khÃ³a, xung Ä‘á»™t, deadlock.</li></ul><hr><h2>1. KHÃI NIá»†M GIAO Dá»ŠCH</h2><p><b>Giao dá»‹ch (Transaction)</b> lÃ  má»™t Ä‘Æ¡n vá»‹ cÃ´ng viá»‡c logic gá»“m nhiá»u thao tÃ¡c SQL Ä‘Æ°á»£c thá»±c hiá»‡n nhÆ° má»™t khá»‘i duy nháº¥t. Má»¥c tiÃªu: Ä‘áº£m báº£o dá»¯ liá»‡u trong CSDL luÃ´n á»Ÿ tráº¡ng thÃ¡i nháº¥t quÃ¡n dÃ¹ cÃ³ lá»—i xáº£y ra.</p><p>VÃ­ dá»¥: Chuyá»ƒn tiá»n giá»¯a hai tÃ i khoáº£n gá»“m hai bÆ°á»›c â€“ trá»« tÃ i khoáº£n A, cá»™ng tÃ i khoáº£n B. Hai thao tÃ¡c nÃ y pháº£i thÃ nh cÃ´ng Ä‘á»“ng thá»i hoáº·c cÃ¹ng bá»‹ há»§y.</p><pre><code>BEGIN TRANSACTION;<br>UPDATE ACCOUNT SET Balance = Balance - 1000 WHERE ID='A01';<br>UPDATE ACCOUNT SET Balance = Balance + 1000 WHERE ID='B02';<br>COMMIT;</code></pre><hr><h2>2. THUá»˜C TÃNH ACID</h2><ul><li><b>Atomicity (TÃ­nh nguyÃªn tá»­):</b> Giao dá»‹ch Ä‘Æ°á»£c thá»±c hiá»‡n toÃ n bá»™ hoáº·c khÃ´ng gÃ¬ cáº£.</li><li><b>Consistency (TÃ­nh nháº¥t quÃ¡n):</b> Sau khi giao dá»‹ch káº¿t thÃºc, dá»¯ liá»‡u váº«n tuÃ¢n thá»§ cÃ¡c rÃ ng buá»™c.</li><li><b>Isolation (TÃ­nh cÃ´ láº­p):</b> CÃ¡c giao dá»‹ch Ä‘á»“ng thá»i khÃ´ng áº£nh hÆ°á»Ÿng Ä‘áº¿n nhau.</li><li><b>Durability (TÃ­nh bá»n vá»¯ng):</b> Sau khi COMMIT, dá»¯ liá»‡u Ä‘Æ°á»£c lÆ°u vÄ©nh viá»…n dÃ¹ há»‡ thá»‘ng gáº·p sá»± cá»‘.</li></ul><hr><h2>3. ÄIá»€U KHIá»‚N GIAO Dá»ŠCH TRONG SQL</h2><p>SQL cung cáº¥p cÃ¡c lá»‡nh Ä‘iá»u khiá»ƒn giao dá»‹ch:</p><ul><li><b>BEGIN TRANSACTION</b>: báº¯t Ä‘áº§u giao dá»‹ch.</li><li><b>COMMIT</b>: xÃ¡c nháº­n thay Ä‘á»•i, lÆ°u dá»¯ liá»‡u.</li><li><b>ROLLBACK</b>: há»§y giao dá»‹ch, khÃ´i phá»¥c dá»¯ liá»‡u trÆ°á»›c Ä‘Ã³.</li><li><b>SAVEPOINT</b>: táº¡o Ä‘iá»ƒm lÆ°u trung gian Ä‘á»ƒ cÃ³ thá»ƒ ROLLBACK má»™t pháº§n.</li></ul><pre><code>BEGIN TRANSACTION;<br>UPDATE SINHVIEN SET Diem=9 WHERE MaSV='SV01';<br>SAVEPOINT S1;<br>UPDATE SINHVIEN SET Diem=5 WHERE MaSV='SV02';<br>ROLLBACK TO S1;<br>COMMIT;</code></pre><hr><h2>4. ÄIá»€U KHIá»‚N Äá»’NG THá»œI VÃ€ KHÃ“A (LOCKING)</h2><p>Khi nhiá»u giao dá»‹ch cÃ¹ng truy cáº­p dá»¯ liá»‡u, DBMS pháº£i Ä‘áº£m báº£o tÃ­nh cÃ´ láº­p báº±ng cÆ¡ cháº¿ khÃ³a.</p><ul><li><b>Shared Lock (KhÃ³a chia sáº»):</b> Cho phÃ©p Ä‘á»c nhÆ°ng khÃ´ng ghi.</li><li><b>Exclusive Lock (KhÃ³a Ä‘á»™c quyá»n):</b> Chá»‰ má»™t giao dá»‹ch cÃ³ thá»ƒ Ä‘á»c/ghi.</li></ul><p>VÃ­ dá»¥: Khi Giao dá»‹ch T1 Ä‘ang cáº­p nháº­t báº£ng ACCOUNT, giao dá»‹ch T2 khÃ´ng thá»ƒ truy cáº­p hÃ ng Ä‘Ã³ cho Ä‘áº¿n khi T1 COMMIT hoáº·c ROLLBACK.</p><hr><h2>5. Má»¨C Äá»˜ CÃ” Láº¬P (ISOLATION LEVEL)</h2><ul><li><b>Read Uncommitted:</b> CÃ³ thá»ƒ Ä‘á»c dá»¯ liá»‡u chÆ°a COMMIT â†’ gÃ¢y lá»—i <i>dirty read</i>.</li><li><b>Read Committed:</b> Chá»‰ Ä‘á»c dá»¯ liá»‡u Ä‘Ã£ COMMIT â†’ ngÄƒn dirty read.</li><li><b>Repeatable Read:</b> NgÄƒn dirty read vÃ  non-repeatable read.</li><li><b>Serializable:</b> CÃ´ láº­p hoÃ n toÃ n, giao dá»‹ch thá»±c thi tuáº§n tá»±.</li></ul><pre><code>SET TRANSACTION ISOLATION LEVEL SERIALIZABLE;</code></pre><hr><h2>6. DEADLOCK (Káº¸T KHÃ“A)</h2><p>Deadlock xáº£y ra khi hai giao dá»‹ch cÃ¹ng chá» nhau giáº£i phÃ³ng tÃ i nguyÃªn. DBMS sáº½ tá»± Ä‘á»™ng phÃ¡t hiá»‡n vÃ  há»§y má»™t giao dá»‹ch Ä‘á»ƒ giáº£i phÃ³ng tÃ i nguyÃªn.</p><pre><code>T1: LOCK A â†’ chá» B<br>T2: LOCK B â†’ chá» A â‡’ Deadlock</code></pre><hr><h2>âœ… Tá»”NG Káº¾T</h2><ul><li>Giao dá»‹ch Ä‘áº£m báº£o dá»¯ liá»‡u nháº¥t quÃ¡n trong mÃ´i trÆ°á»ng Ä‘a ngÆ°á»i dÃ¹ng.</li><li>ACID lÃ  bá»‘n nguyÃªn táº¯c cÆ¡ báº£n Ä‘áº£m báº£o Ä‘á»™ tin cáº­y cá»§a giao dá»‹ch.</li><li>COMMIT, ROLLBACK, SAVEPOINT giÃºp kiá»ƒm soÃ¡t quÃ¡ trÃ¬nh thá»±c thi.</li><li>Hiá»ƒu cÆ¡ cháº¿ khÃ³a vÃ  cÃ´ láº­p lÃ  ná»n táº£ng cho láº­p trÃ¬nh Ä‘á»“ng thá»i an toÃ n.</li></ul>",
  "updated_at": null
}