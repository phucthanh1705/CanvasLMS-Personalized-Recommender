{
  "id": "lesson_bai-3-ma-hoa-doi-xung-hien-dai",
  "title": "lesson_bai-3-ma-hoa-doi-xung-hien-dai",
  "body": "<h1>ğŸ§  BÃ€I 3 â€“ MÃƒ HÃ“A Äá»I Xá»¨NG HIá»†N Äáº I</h1><h2>ğŸ¯ Má»¥c tiÃªu há»c táº­p</h2><ul><li>Hiá»ƒu nguyÃªn lÃ½ hoáº¡t Ä‘á»™ng cá»§a cÃ¡c há»‡ mÃ£ dÃ²ng (Stream Cipher) vÃ  mÃ£ khá»‘i (Block Cipher).</li><li>Náº¯m cáº¥u trÃºc Feistel, thuáº­t toÃ¡n DES, AES vÃ  cÃ¡c mode váº­n hÃ nh.</li><li>PhÃ¢n tÃ­ch Æ°u, nhÆ°á»£c Ä‘iá»ƒm cá»§a tá»«ng loáº¡i mÃ£ vÃ  Ä‘Ã¡nh giÃ¡ Ä‘á»™ an toÃ n cá»§a chÃºng.</li><li>Hiá»ƒu cÃ¡c á»©ng dá»¥ng thá»±c táº¿ cá»§a mÃ£ khá»‘i trong báº£o máº­t truyá»n thÃ´ng (TLS, IPsec, VPN, v.v.).</li></ul><hr><h2>1. MÃƒ DÃ’NG (STREAM CIPHER)</h2><p>MÃ£ dÃ²ng mÃ£ hÃ³a dá»¯ liá»‡u tá»«ng bit hoáº·c byte theo luá»“ng, sá»­ dá»¥ng khÃ³a sinh chuá»—i giáº£ ngáº«u nhiÃªn (keystream). QuÃ¡ trÃ¬nh mÃ£ hÃ³a: C = P XOR Kstream. Giáº£i mÃ£: P = C XOR Kstream. Æ¯u Ä‘iá»ƒm lÃ  tá»‘c Ä‘á»™ cao, phÃ¹ há»£p cho truyá»n thÃ´ng thá»i gian thá»±c, nhÆ°ng pháº£i Ä‘áº£m báº£o khÃ´ng tÃ¡i sá»­ dá»¥ng keystream.</p><h3>1.1 Tiny RC4</h3><p>RC4 lÃ  mÃ£ dÃ²ng phá»• biáº¿n, dÃ¹ng hoÃ¡n vá»‹ 256 byte vÃ  khÃ³a bÃ­ máº­t Ä‘á»ƒ táº¡o chuá»—i ngáº«u nhiÃªn. Tuy nhiÃªn, cÃ¡c Ä‘iá»ƒm yáº¿u khá»Ÿi táº¡o KSA (Key Scheduling Algorithm) khiáº¿n RC4 khÃ´ng cÃ²n an toÃ n. PhiÃªn báº£n Tiny RC4 Ä‘Æ°á»£c dÃ¹ng cho má»¥c Ä‘Ã­ch há»c thuáº­t, mÃ´ phá»ng cÆ¡ cháº¿ sinh keystream báº±ng hoÃ¡n vá»‹ vÃ  XOR liÃªn tá»¥c.</p><h3>1.2 RC4 thá»±c táº¿</h3><p>RC4 tá»«ng Ä‘Æ°á»£c sá»­ dá»¥ng trong SSL/TLS, WEP, WPA. Sau nÃ y bá»‹ loáº¡i bá» do lá»™ bias trong keystream. VÃ­ dá»¥: byte Ä‘áº§u RC4 bá»‹ lá»‡ch, cho phÃ©p táº¥n cÃ´ng giáº£i mÃ£ má»™t pháº§n ná»™i dung.</p><hr><h2>2. MÃƒ KHá»I (BLOCK CIPHER)</h2><p>MÃ£ khá»‘i mÃ£ hÃ³a dá»¯ liá»‡u theo tá»«ng khá»‘i (block) cá»‘ Ä‘á»‹nh, thÆ°á»ng 64 hoáº·c 128 bit. QuÃ¡ trÃ¬nh: C = E<sub>K</sub>(Pblock), P = D<sub>K</sub>(Cblock). CÃ¡c há»‡ mÃ£ khá»‘i tiÃªu biá»ƒu: DES, 3DES, AES. MÃ£ khá»‘i Ä‘Æ°á»£c xem lÃ  ná»n táº£ng cá»§a cÃ¡c há»‡ thá»‘ng báº£o máº­t hiá»‡n Ä‘áº¡i.</p><h3>2.1 Máº¡ng SPN (Substitutionâ€“Permutation Network)</h3><p>LÃ  mÃ´ hÃ¬nh gá»“m nhiá»u vÃ²ng láº·p, má»—i vÃ²ng cÃ³ cÃ¡c lá»›p thay tháº¿ (S-box), hoÃ¡n vá»‹ (P-box), vÃ  trá»™n khÃ³a vÃ²ng (Round Key). AES lÃ  vÃ­ dá»¥ Ä‘iá»ƒn hÃ¬nh cá»§a SPN, Ä‘áº£m báº£o khuáº¿ch tÃ¡n (diffusion) vÃ  nháº§m láº«n (confusion) theo lÃ½ thuyáº¿t Shannon.</p><h3>2.2 MÃ´ hÃ¬nh Feistel</h3><p>Feistel chia block thÃ nh hai ná»­a L vÃ  R, thá»±c hiá»‡n hoÃ¡n Ä‘á»•i qua nhiá»u vÃ²ng: L<sub>i</sub> = R<sub>i-1</sub>, R<sub>i</sub> = L<sub>i-1</sub> XOR F(R<sub>i-1</sub>, K<sub>i</sub>). MÃ´ hÃ¬nh nÃ y cho phÃ©p cÃ¹ng thuáº­t toÃ¡n xá»­ lÃ½ mÃ£ hÃ³a vÃ  giáº£i mÃ£ (chá»‰ Ä‘áº£o thá»© tá»± khÃ³a). DES lÃ  vÃ­ dá»¥ tiÃªu biá»ƒu.</p><hr><h2>3. THUáº¬T TOÃN DES (Data Encryption Standard)</h2><p>DES lÃ  chuáº©n mÃ£ hÃ³a cá»§a Hoa Ká»³ tá»« nÄƒm 1977, dÃ¹ng khÃ³a 64 bit (56 bit thá»±c + 8 bit kiá»ƒm tra cháºµn láº»). DES cÃ³ 16 vÃ²ng Feistel, má»—i vÃ²ng gá»“m cÃ¡c phÃ©p má»Ÿ rá»™ng, XOR vá»›i khÃ³a con, thay tháº¿ báº±ng S-box (8 báº£ng 6x4), vÃ  hoÃ¡n vá»‹ P-box.</p><p><b>Hiá»‡u á»©ng Avalanche:</b> thay Ä‘á»•i 1 bit trong báº£n rÃµ hoáº·c khÃ³a dáº«n Ä‘áº¿n thay Ä‘á»•i khoáº£ng 50% bit báº£n mÃ£. Tuy nhiÃªn, do khÃ³a 56 bit, DES bá»‹ brute-force phÃ¡ vá»¡ (2^56 thá»­ nghiá»‡m kháº£ thi).</p><h3>3.1 3DES</h3><p>Äá»ƒ tÄƒng an toÃ n, 3DES Ã¡p dá»¥ng DES 3 láº§n (EDE: Encryptâ€“Decryptâ€“Encrypt) vá»›i 2 hoáº·c 3 khÃ³a khÃ¡c nhau, Ä‘á»™ an toÃ n ~112 bit. DÃ¹ an toÃ n, nhÆ°ng cháº­m nÃªn Ä‘Ã£ bá»‹ AES thay tháº¿.</p><hr><h2>4. AES (Advanced Encryption Standard)</h2><p>AES (Rijndael) lÃ  chuáº©n mÃ£ khá»‘i hiá»‡n Ä‘áº¡i, sá»­ dá»¥ng block 128 bit, khÃ³a 128/192/256 bit. Cáº¥u trÃºc dá»±a trÃªn máº¡ng SPN vá»›i 4 phÃ©p biáº¿n Ä‘á»•i: <b>SubBytes</b> (thay tháº¿ S-box phi tuyáº¿n), <b>ShiftRows</b> (dá»‹ch vÃ²ng), <b>MixColumns</b> (nhÃ¢n ma tráº­n trong GF(2^8)), <b>AddRoundKey</b> (XOR vá»›i khÃ³a vÃ²ng). AES-128 cÃ³ 10 vÃ²ng, AES-192 cÃ³ 12 vÃ²ng, AES-256 cÃ³ 14 vÃ²ng.</p><p><b>Äáº·c Ä‘iá»ƒm:</b> nhanh, an toÃ n, chá»‘ng háº§u háº¿t táº¥n cÃ´ng tuyáº¿n tÃ­nh vÃ  vi sai; nhÆ°ng cáº§n quáº£n lÃ½ khÃ³a vÃ  cháº¿ Ä‘á»™ váº­n hÃ nh Ä‘Ãºng cÃ¡ch.</p><hr><h2>5. CÃC MODE Váº¬N HÃ€NH (BLOCK CIPHER MODES)</h2><ul><li><b>ECB (Electronic Code Book):</b> má»—i block mÃ£ hÃ³a Ä‘á»™c láº­p â†’ dá»… bá»‹ nháº­n dáº¡ng máº«u, <b>khÃ´ng nÃªn dÃ¹ng</b>.</li><li><b>CBC (Cipher Block Chaining):</b> má»—i block XOR vá»›i block trÆ°á»›c; cáº§n IV ngáº«u nhiÃªn, trÃ¡nh tÃ¡i sá»­ dá»¥ng IV.</li><li><b>CFB (Cipher Feedback):</b> mÃ£ hÃ³a theo tá»«ng pháº§n nhá», dÃ¹ng pháº£n há»“i tá»« cipher Ä‘á»ƒ táº¡o luá»“ng.</li><li><b>OFB (Output Feedback):</b> táº¡o keystream Ä‘á»™c láº­p, khÃ´ng phá»¥ thuá»™c vÃ o báº£n rÃµ.</li><li><b>CTR (Counter):</b> sá»­ dá»¥ng bá»™ Ä‘áº¿m káº¿t há»£p nonce â†’ há»— trá»£ song song, thÆ°á»ng dÃ¹ng trong AES-GCM.</li></ul><hr><h2>6. á»¨NG Dá»¤NG VÃ€ Báº¢O Máº¬T</h2><ul><li><b>AES-GCM:</b> káº¿t há»£p CTR vÃ  xÃ¡c thá»±c Galois MAC â†’ báº£o máº­t vÃ  toÃ n váº¹n.</li><li><b>ChaCha20-Poly1305:</b> dÃ¹ng trong TLS 1.3 vÃ  SSH.</li><li><b>DES vÃ  RC4:</b> hiá»‡n bá»‹ loáº¡i bá» khá»i chuáº©n báº£o máº­t.</li><li>Viá»‡c tÃ¡i sá»­ dá»¥ng IV, nonce hoáº·c keystream lÃ  nguyÃªn nhÃ¢n chÃ­nh gÃ¢y lá»™ dá»¯ liá»‡u trong mÃ£ Ä‘á»‘i xá»©ng hiá»‡n Ä‘áº¡i.</li></ul><hr><h2>âœ… Tá»”NG Káº¾T</h2><ul><li>MÃ£ dÃ²ng nhanh, nháº¹, nhÆ°ng cáº§n keystream Ä‘á»™c nháº¥t.</li><li>MÃ£ khá»‘i máº¡nh, báº£o máº­t cao, nhÆ°ng phá»¥ thuá»™c vÃ o cháº¿ Ä‘á»™ váº­n hÃ nh.</li><li>AES lÃ  chuáº©n hiá»‡n hÃ nh nhá» tá»‘c Ä‘á»™, Ä‘á»™ an toÃ n vÃ  há»— trá»£ pháº§n cá»©ng.</li></ul>",
  "updated_at": null
}