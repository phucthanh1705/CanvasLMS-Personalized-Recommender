<h1>B√†i 04 ‚Äì JDBC V√Ä SPRING JDBC</h1><h2>üéØ M·ª•c ti√™u h·ªçc t·∫≠p</h2><ul>  <li>Hi·ªÉu kh√°i ni·ªám v√† c∆° ch·∫ø ho·∫°t ƒë·ªông c·ªßa JDBC (Java Database Connectivity).</li>  <li>Th·ª±c hi·ªán ƒë∆∞·ª£c thao t√°c k·∫øt n·ªëi, truy v·∫•n, th√™m, s·ª≠a, x√≥a d·ªØ li·ªáu v·ªõi c∆° s·ªü d·ªØ li·ªáu.</li>  <li>Bi·∫øt c·∫•u h√¨nh <b>Spring JDBC</b> v√† s·ª≠ d·ª•ng <code>JdbcTemplate</code> ƒë·ªÉ ƒë∆°n gi·∫£n h√≥a thao t√°c d·ªØ li·ªáu.</li>  <li>√Åp d·ª•ng giao t√°c (Transaction) v√† x·ª≠ l√Ω ngo·∫°i l·ªá trong truy c·∫≠p d·ªØ li·ªáu.</li></ul><hr><h2>1. Gi·ªõi thi·ªáu JDBC</h2><p>JDBC (Java Database Connectivity) l√† API c·ªßa Java cho ph√©p c√°c ·ª©ng d·ª•ng k·∫øt n·ªëi v√† t∆∞∆°ng t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu (MySQL, PostgreSQL, Oracle, v.v).</p><p><b>Ki·∫øn tr√∫c JDBC g·ªìm 4 th√†nh ph·∫ßn ch√≠nh:</b></p><ol>  <li><b>Driver Manager:</b> Qu·∫£n l√Ω c√°c JDBC Driver.</li>  <li><b>Driver:</b> Th∆∞ vi·ªán c·ªßa t·ª´ng DBMS (MySQL, PostgreSQL...).</li>  <li><b>Connection:</b> K·∫øt n·ªëi gi·ªØa ·ª©ng d·ª•ng v√† CSDL.</li>  <li><b>Statement / PreparedStatement:</b> D√πng ƒë·ªÉ th·ª±c thi c√°c c√¢u l·ªánh SQL.</li></ol><hr><h2>2. Thi·∫øt l·∫≠p m√¥i tr∆∞·ªùng v√† k·∫øt n·ªëi CSDL</h2><p><b>B∆∞·ªõc 1:</b> Th√™m th∆∞ vi·ªán JDBC Driver (v√≠ d·ª• MySQL):</p><pre><code>mysql-connector-j-8.x.x.jar</code></pre><p><b>B∆∞·ªõc 2:</b> T·∫°o c∆° s·ªü d·ªØ li·ªáu:</p><pre><code>CREATE DATABASE student_db;USE student_db;CREATE TABLE student (  id INT AUTO_INCREMENT PRIMARY KEY,  name VARCHAR(100),  score DOUBLE);</code></pre><p><b>B∆∞·ªõc 3:</b> K·∫øt n·ªëi JDBC trong Java:</p><pre><code>import java.sql.*;public class JdbcExample {    public static void main(String[] args) {        String url = "jdbc:mysql://localhost:3306/student_db";        String user = "root";        String password = "123456";        try (Connection conn = DriverManager.getConnection(url, user, password)) {            System.out.println("K·∫øt n·ªëi th√†nh c√¥ng!");        } catch (SQLException e) {            e.printStackTrace();        }    }}</code></pre><hr><h2>3. Th·ª±c hi·ªán c√°c thao t√°c CRUD c∆° b·∫£n</h2><h3>Th√™m d·ªØ li·ªáu (INSERT):</h3><pre><code>String sql = "INSERT INTO student(name, score) VALUES (?, ?)";PreparedStatement ps = conn.prepareStatement(sql);ps.setString(1, "Nguyen Van A");ps.setDouble(2, 9.0);ps.executeUpdate();</code></pre><h3>Truy v·∫•n d·ªØ li·ªáu (SELECT):</h3><pre><code>String sql = "SELECT * FROM student";Statement st = conn.createStatement();ResultSet rs = st.executeQuery(sql);while (rs.next()) {    System.out.println(rs.getInt("id") + " - " + rs.getString("name"));}</code></pre><h3>C·∫≠p nh·∫≠t (UPDATE) v√† X√≥a (DELETE):</h3><pre><code>String update = "UPDATE student SET score=? WHERE id=?";PreparedStatement ps = conn.prepareStatement(update);ps.setDouble(1, 8.5);ps.setInt(2, 1);ps.executeUpdate();String delete = "DELETE FROM student WHERE id=?";PreparedStatement del = conn.prepareStatement(delete);del.setInt(1, 1);del.executeUpdate();</code></pre><hr><h2>4. Spring JDBC ‚Äì Gi·ªõi thi·ªáu</h2><p>Spring JDBC l√† module trong Spring Framework gi√∫p ƒë∆°n gi·∫£n h√≥a thao t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu th√¥ng qua l·ªõp <code>JdbcTemplate</code>.</p><p><b>∆Øu ƒëi·ªÉm:</b></p><ul>  <li>T·ª± ƒë·ªông qu·∫£n l√Ω k·∫øt n·ªëi v√† ƒë√≥ng t√†i nguy√™n.</li>  <li>Gi·∫£m thi·ªÉu m√£ l·∫∑p (boilerplate code).</li>  <li>T√≠ch h·ª£p s·∫µn x·ª≠ l√Ω transaction v√† exception.</li></ul><hr><h2>5. C·∫•u h√¨nh Spring JDBC</h2><h3>5.1. File c·∫•u h√¨nh XML:</h3><pre><code>&lt;beans xmlns="http://www.springframework.org/schema/beans"       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"       xsi:schemaLocation="http://www.springframework.org/schema/beans       http://www.springframework.org/schema/beans/spring-beans.xsd"&gt;    &lt;bean id="dataSource"          class="org.springframework.jdbc.datasource.DriverManagerDataSource"&gt;        &lt;property name="driverClassName" value="com.mysql.cj.jdbc.Driver"/&gt;        &lt;property name="url" value="jdbc:mysql://localhost:3306/student_db"/&gt;        &lt;property name="username" value="root"/&gt;        &lt;property name="password" value="123456"/&gt;    &lt;/bean&gt;    &lt;bean id="jdbcTemplate"          class="org.springframework.jdbc.core.JdbcTemplate"&gt;        &lt;property name="dataSource" ref="dataSource"/&gt;    &lt;/bean&gt;&lt;/beans&gt;</code></pre><h3>5.2. C·∫•u h√¨nh Annotation:</h3><pre><code>@Configurationpublic class AppConfig {    @Bean    public DataSource dataSource() {        DriverManagerDataSource ds = new DriverManagerDataSource();        ds.setDriverClassName("com.mysql.cj.jdbc.Driver");        ds.setUrl("jdbc:mysql://localhost:3306/student_db");        ds.setUsername("root");        ds.setPassword("123456");        return ds;    }    @Bean    public JdbcTemplate jdbcTemplate(DataSource ds) {        return new JdbcTemplate(ds);    }}</code></pre><hr><h2>6. Thao t√°c d·ªØ li·ªáu b·∫±ng JdbcTemplate</h2><p><b>Th√™m d·ªØ li·ªáu:</b></p><pre><code>@Autowiredprivate JdbcTemplate jdbcTemplate;public void addStudent(String name, double score) {    String sql = "INSERT INTO student(name, score) VALUES(?, ?)";    jdbcTemplate.update(sql, name, score);}</code></pre><p><b>L·∫•y d·ªØ li·ªáu:</b></p><pre><code>public List&lt;Student&gt; getAllStudents() {    String sql = "SELECT * FROM student";    return jdbcTemplate.query(sql, (rs, rowNum) -&gt;        new Student(rs.getInt("id"), rs.getString("name"), rs.getDouble("score"))    );}</code></pre><p><b>L·∫•y m·ªôt b·∫£n ghi:</b></p><pre><code>public Student findById(int id) {    String sql = "SELECT * FROM student WHERE id=?";    return jdbcTemplate.queryForObject(sql, new Object[]{id}, (rs, rowNum) -&gt;        new Student(rs.getInt("id"), rs.getString("name"), rs.getDouble("score"))    );}</code></pre><hr><h2>7. Qu·∫£n l√Ω giao t√°c (Transaction Management)</h2><p>Spring h·ªó tr·ª£ <b>@Transactional</b> ƒë·ªÉ t·ª± ƒë·ªông rollback khi c√≥ l·ªói.</p><pre><code>@Servicepublic class StudentService {    @Autowired    private JdbcTemplate jdbcTemplate;    @Transactional    public void transferScore(int fromId, int toId, double value) {        jdbcTemplate.update("UPDATE student SET score=score-? WHERE id=?", value, fromId);        jdbcTemplate.update("UPDATE student SET score=score+? WHERE id=?", value, toId);    }}</code></pre><p>N·∫øu x·∫£y ra l·ªói ·ªü m·ªôt c√¢u l·ªánh, to√†n b·ªô giao d·ªãch s·∫Ω b·ªã rollback.</p><hr><h2>8. X·ª≠ l√Ω ngo·∫°i l·ªá trong Spring JDBC</h2><p>Spring JDBC n√©m ra c√°c exception n·∫±m trong h·ªá th·ªëng <b>DataAccessException</b>, v√≠ d·ª•:</p><ul>  <li><code>BadSqlGrammarException</code> ‚Äì l·ªói c√∫ ph√°p SQL.</li>  <li><code>DataIntegrityViolationException</code> ‚Äì vi ph·∫°m r√†ng bu·ªôc d·ªØ li·ªáu.</li>  <li><code>DuplicateKeyException</code> ‚Äì tr√πng kh√≥a ch√≠nh.</li></ul><pre><code>try {    jdbcTemplate.update("INSERT INTO student(id,name) VALUES(1,'A')");} catch (DataAccessException ex) {    System.out.println("L·ªói c∆° s·ªü d·ªØ li·ªáu: " + ex.getMessage());}</code></pre><hr><h2>üß† B√†i t·∫≠p g·ª£i √Ω</h2><ol>  <li>C√†i ƒë·∫∑t MySQL v√† t·∫°o b·∫£ng <code>student</code>.</li>  <li>Vi·∫øt ch∆∞∆°ng tr√¨nh Java JDBC ƒë∆°n gi·∫£n hi·ªÉn th·ªã danh s√°ch sinh vi√™n.</li>  <li>C·∫•u h√¨nh Spring JDBC v√† th·ª±c hi·ªán CRUD b·∫±ng <code>JdbcTemplate</code>.</li>  <li>Th·ª±c h√†nh Transaction v·ªõi hai b·∫£n ghi kh√°c nhau.</li>  <li>Th·ª≠ c·ªë t√¨nh t·∫°o l·ªói SQL v√† quan s√°t Spring x·ª≠ l√Ω Exception.</li></ol><hr><h2>‚úÖ T·ªïng k·∫øt</h2><p>Module n√†y gi√∫p sinh vi√™n n·∫Øm ƒë∆∞·ª£c c√°ch k·∫øt n·ªëi v√† thao t√°c v·ªõi c∆° s·ªü d·ªØ li·ªáu b·∫±ng c·∫£ <b>JDBC truy·ªÅn th·ªëng</b> v√† <b>Spring JDBC</b>. K·ªπ nƒÉng n√†y r·∫•t quan tr·ªçng ƒë·ªÉ chuy·ªÉn sang <strong>Module M05 ‚Äì Hibernate (ORM)</strong>, n∆°i d·ªØ li·ªáu ƒë∆∞·ª£c √°nh x·∫° t·ª± ƒë·ªông gi·ªØa ƒë·ªëi t∆∞·ª£ng v√† b·∫£ng trong CSDL.</p>