{
  "id": "lesson_bai-08-ky-thuat-truyen-du-lieu-trong-asp-dot-net-core-mvc",
  "title": "lesson_bai-08-ky-thuat-truyen-du-lieu-trong-asp-dot-net-core-mvc",
  "body": "<h1>ğŸ§© BÃ€I 08 â€“ Ká»¸ THUáº¬T TRUYá»€N Dá»® LIá»†U TRONG ASP.NET CORE MVC</h1><h2>ğŸ¯ Má»¥c tiÃªu há»c táº­p</h2><ul><li>Hiá»ƒu cÃ¡c phÆ°Æ¡ng phÃ¡p truyá»n dá»¯ liá»‡u giá»¯a Controller vÃ  View trong MVC.</li><li>PhÃ¢n biá»‡t giá»¯a <b>ViewBag</b>, <b>ViewData</b> vÃ  <b>TempData</b>.</li><li>Thá»±c hÃ nh nháº­n dá»¯ liá»‡u tá»« form báº±ng <b>Model Binding</b>.</li><li>Ãp dá»¥ng cÃ¡c ká»¹ thuáº­t Ä‘á»ƒ chia sáº» dá»¯ liá»‡u trong vÃ²ng Ä‘á»i request.</li></ul><hr><h2>1. Tá»•ng quan vá» truyá»n dá»¯ liá»‡u trong MVC</h2><p>Khi ngÆ°á»i dÃ¹ng gá»­i yÃªu cáº§u (request), Controller xá»­ lÃ½ dá»¯ liá»‡u vÃ  truyá»n cho View hiá»ƒn thá»‹. CÃ³ nhiá»u cÃ¡ch Ä‘á»ƒ truyá»n dá»¯ liá»‡u:</p><ul><li><b>ViewData</b> â€“ dáº¡ng tá»« Ä‘iá»ƒn (dictionary) lÆ°u dá»¯ liá»‡u táº¡m thá»i trong request.</li><li><b>ViewBag</b> â€“ wrapper Ä‘á»™ng (dynamic) cá»§a ViewData.</li><li><b>TempData</b> â€“ lÆ°u dá»¯ liá»‡u giá»¯a 2 request (chuyá»ƒn trang, redirect).</li><li><b>Model Binding</b> â€“ Ã¡nh xáº¡ dá»¯ liá»‡u form sang Ä‘á»‘i tÆ°á»£ng Model.</li></ul><hr><h2>2. ViewData</h2><p>ViewData lÃ  má»™t Ä‘á»‘i tÆ°á»£ng kiá»ƒu <code>ViewDataDictionary</code>, lÆ°u dá»¯ liá»‡u dáº¡ng keyâ€“value.</p><h3>VÃ­ dá»¥:</h3><pre><code>// Controllerpublic IActionResult Index(){    ViewData[\"Title\"] = \"Trang chá»§\";    ViewData[\"Message\"] = \"ChÃ o má»«ng báº¡n Ä‘áº¿n vá»›i MVC Core!\";    return View();}</code></pre><pre><code>// View (Index.cshtml)&lt;h2&gt;@ViewData[\"Title\"]&lt;/h2&gt;&lt;p&gt;@ViewData[\"Message\"]&lt;/p&gt;</code></pre><p><b>Äáº·c Ä‘iá»ƒm:</b></p><ul><li>Kiá»ƒu dá»¯ liá»‡u: keyâ€“value (string â†’ object).</li><li>Chá»‰ tá»“n táº¡i trong request hiá»‡n táº¡i.</li><li>Pháº£i kiá»ƒm tra null khi sá»­ dá»¥ng.</li></ul><hr><h2>3. ViewBag</h2><p>ViewBag lÃ  má»™t thuá»™c tÃ­nh Ä‘á»™ng (dynamic object) dÃ¹ng Ä‘á»ƒ truyá»n dá»¯ liá»‡u tá»« Controller sang View dá»… hÆ¡n.</p><h3>VÃ­ dá»¥:</h3><pre><code>// Controllerpublic IActionResult Info(){    ViewBag.Name = \"Nguyá»…n VÄƒn A\";    ViewBag.Score = 8.5;    return View();}</code></pre><pre><code>// View&lt;p&gt;Há» tÃªn: @ViewBag.Name&lt;/p&gt;&lt;p&gt;Äiá»ƒm trung bÃ¬nh: @ViewBag.Score&lt;/p&gt;</code></pre><p><b>So sÃ¡nh nhanh:</b></p><table border=\"1\" cellpadding=\"6\" cellspacing=\"0\"><thead><tr><th>TiÃªu chÃ­</th><th>ViewData</th><th>ViewBag</th></tr></thead><tbody><tr><td>Kiá»ƒu dá»¯ liá»‡u</td><td>Dictionary (key-value)</td><td>Dynamic object</td></tr><tr><td>Pháº¡m vi tá»“n táº¡i</td><td>Trong request</td><td>Trong request</td></tr><tr><td>CÃ¡ch truy cáº­p</td><td>ViewData[\"key\"]</td><td>ViewBag.key</td></tr></tbody></table><hr><h2>4. TempData</h2><p><b>TempData</b> lÆ°u dá»¯ liá»‡u trong <b>Session</b> Ä‘á»ƒ chia sáº» giá»¯a 2 request liá»n nhau, thÆ°á»ng dÃ¹ng khi <b>Redirect</b>.</p><h3>VÃ­ dá»¥:</h3><pre><code>// Controller Apublic IActionResult Save(){    TempData[\"Notice\"] = \"LÆ°u dá»¯ liá»‡u thÃ nh cÃ´ng!\";    return RedirectToAction(\"Result\");}// Controller Bpublic IActionResult Result(){    ViewBag.Message = TempData[\"Notice\"];    return View();}</code></pre><p><b>LÆ°u Ã½:</b> Sau khi Ä‘á»c, TempData tá»± Ä‘á»™ng bá»‹ xÃ³a (chá»‰ tá»“n táº¡i 1 láº§n).</p><hr><h2>5. Model Binding</h2><p><b>Model Binding</b> lÃ  cÆ¡ cháº¿ tá»± Ä‘á»™ng Ã¡nh xáº¡ dá»¯ liá»‡u tá»« form HTML hoáº·c query string vÃ o tham sá»‘ trong Action hoáº·c Model class.</p><h3>VÃ­ dá»¥ 1 â€“ Ã¡nh xáº¡ tham sá»‘ Ä‘Æ¡n:</h3><pre><code>// View&lt;form asp-action=\"Greet\" method=\"post\"&gt;  &lt;input type=\"text\" name=\"name\" /&gt;  &lt;button&gt;Gá»­i&lt;/button&gt;&lt;/form&gt;// Controller[HttpPost]public IActionResult Greet(string name){    ViewBag.Message = $\"Xin chÃ o {name}!\";    return View();}</code></pre><h3>VÃ­ dá»¥ 2 â€“ Ã¡nh xáº¡ Model:</h3><pre><code>public class Student{    public string Name { get; set; }    public double GPA { get; set; }}[HttpPost]public IActionResult Register(Student s){    return View(s);}</code></pre><pre><code>// View&lt;form asp-action=\"Register\" method=\"post\"&gt;  &lt;input name=\"Name\" /&gt;  &lt;input name=\"GPA\" /&gt;  &lt;button&gt;Gá»­i&lt;/button&gt;&lt;/form&gt;</code></pre><p>ASP.NET Core tá»± Ä‘á»™ng bind dá»¯ liá»‡u vÃ o Ä‘á»‘i tÆ°á»£ng <code>Student</code>.</p><hr><h2>6. Truyá»n dá»¯ liá»‡u ngÆ°á»£c tá»« View vá» Controller</h2><ul><li>ThÃ´ng qua form POST (form action + input name trÃ¹ng vá»›i Model/Parameter).</li><li>ThÃ´ng qua AJAX (gá»­i JSON vá» Controller).</li></ul><h3>VÃ­ dá»¥ AJAX:</h3><pre><code>$.ajax({  type: 'POST',  url: '/Home/Register',  data: JSON.stringify({ Name: 'An', GPA: 9 }),  contentType: 'application/json; charset=utf-8'});</code></pre><hr><h2>7. TÃ¬nh huá»‘ng káº¿t há»£p</h2><p>Khi cáº§n hiá»ƒn thá»‹ thÃ´ng bÃ¡o sau khi thÃªm sinh viÃªn, ta cÃ³ thá»ƒ dÃ¹ng TempData:</p><pre><code>TempData[\"Notice\"] = \"ÄÃ£ thÃªm sinh viÃªn thÃ nh cÃ´ng!\";return RedirectToAction(\"Index\");</code></pre><p>Trong View Index:</p><pre><code>&lt;div class=\"alert alert-success\"&gt;@TempData[\"Notice\"]&lt;/div&gt;</code></pre><hr><h2>ğŸ§  BÃ i táº­p thá»±c hÃ nh</h2><ol><li>Táº¡o trang Controller <code>HomeController</code> cÃ³ action <code>Info()</code> dÃ¹ng ViewBag Ä‘á»ƒ hiá»ƒn thá»‹ thÃ´ng tin cÃ¡ nhÃ¢n.</li><li>DÃ¹ng ViewData Ä‘á»ƒ truyá»n danh sÃ¡ch sinh viÃªn (List&lt;string&gt;) sang View vÃ  hiá»ƒn thá»‹.</li><li>DÃ¹ng TempData Ä‘á»ƒ hiá»ƒn thá»‹ thÃ´ng bÃ¡o khi chuyá»ƒn trang.</li><li>Táº¡o form Ä‘Äƒng kÃ½ sinh viÃªn, nháº­n dá»¯ liá»‡u báº±ng Model Binding.</li><li>DÃ¹ng AJAX gá»­i dá»¯ liá»‡u JSON lÃªn Controller vÃ  hiá»ƒn thá»‹ pháº£n há»“i trong View.</li></ol><hr><h2>âœ… Tá»•ng káº¿t</h2><ul><li>Hiá»ƒu rÃµ cÃ¡c phÆ°Æ¡ng phÃ¡p truyá»n dá»¯ liá»‡u trong MVC.</li><li>Biáº¿t khi nÃ o dÃ¹ng ViewBag, ViewData, TempData, Model Binding.</li><li>CÃ³ thá»ƒ xá»­ lÃ½ luá»“ng dá»¯ liá»‡u Controller â†’ View â†’ Controller.</li><li>Ãp dá»¥ng vÃ o á»©ng dá»¥ng ASP.NET Core MVC thá»±c táº¿ (CRUD, form, thÃ´ng bÃ¡o,â€¦).</li></ul>",
  "updated_at": null
}